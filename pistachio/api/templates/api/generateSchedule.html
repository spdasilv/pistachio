{% extends "api/index.html" %}
{% block content %}
{% if trip.stage == 3 %}
    {% load static %}
    <html>
    <head>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
        <script src="../js/fontawesome/fontawesome-all.js"></script>

        <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        /* Style the buttons that are used to open the tab content */
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 11px 50px;
            transition: 0.3s;
        }

        .tab button h4 {
            color:var(--darkergrey);
            text-transform: uppercase;
        }

        /* Change background color of buttons on hover */
        .tab button:hover h4 {
            color:var(--green);
        }

        /* Create an active/current tablink class */
        .tab button.active h4{
            color:var(--green);
        }

        /* Style the tab content */
        .tabcontent {
            display: none;
            border-top: none;
            padding: 20px 50px;
        }
        .dayContent {
            border-top: none;
            margin-top: -20px;
            margin-bottom: -20px;
            margin-left:-50px;
            margin-right:-50px;
        }
        .tabcontent h2 {
            text-transform: uppercase;
            color:var(--darkwriting);
            letter-spacing:1.5px;
            padding-bottom:20px;
            border-bottom:1px solid var(--darkergrey);
            margin-bottom:20px;
        }

        .half-tab {
            width:50%;
            float: left;
            display:inline-block;
            padding: 20px 50px;
        }

       #map {
            height: 87%;
            float: left;
            width:50%;
            border: none;
            display:inline-block;
       }
       #directions-panel {
            border:none;
            overflow-y:scroll;
            height: 65%;
            padding-top:10px;
            padding-bottom:10px;
       }
       .LocationDesc{
            padding-top:0px;
            padding-bottom:0px;
            float: left;
            width:20%;
            border: none;
            display:inline-block;
       }
       .ptLetter{
            font-size:14px;
            color: var(--gold);
            margin-bottom:-14px;
       }
       .ptTime{
            font-size:17px;
            color: var(--darkwriting);
            font-weight:bold;
            margin-bottom:-12px;
       }
       .ptName{
            font-size:13px;
            color: var(--darkergrey);
            font-weight:lighter;
       }
       .locDivider{
            float: left;
            width:18%;
            display:inline-block;
            height:83px;
            padding-top:35px;
            position:absoluate;
       }
       .TransMode{
            font-size:11px;
            color: var(--darkergrey);
            font-weight:normal;
            float: left;
            width:20%;
            display:inline-block;
            padding-top:24px;
            padding-bottom:24px;
            text-align:center;
       }
       .lenStay{
            background-color:var(--silver);
            text-align:center;
            padding-bottom:2px;
            border-color:var(--darkergrey);
            border-style: solid;
            border-width: 1px;
       }
       .suggTime{
            font-size:11px;
            color: var(--darkergrey);
            font-weight:lighter;
            margin-bottom:-12px;
       }
       .depTime{
            font-size:11px;
            color: var(--gold);
       }
       .Suggestion{
            height:83px;
            float: left;
            width:100%;
            padding-left:20%;
            padding-right:20%;
            padding-top:16px;
       }
</style>
    </head>
    <body>
        <!------- -->
        <div class="parent-container1">
            <h5 class="sub-title">
                <a href="{% url 'api:home' %}">
                    ⫷   Back to home
                </a>
            </h5>
            <h2 class="main-title" style="float:left">
                TRIP TO {{ trip.city.name }}
            </h2>
            <div>
                
                <hr>
                    <div class="box-container">

                            <!-- Tab links -->
                        <div class="tab box-header schedule-header">
                          <button class="tablinks" onclick="openCity(event, 'Overview')"><h4>Overview</h4></button>
                          <button class="tablinks" onclick="openCity(event, 'Day1')" id="submit"><h4>Day 1</h4></button>
                          <button class="tablinks" onclick="openCity(event, 'Day2')"><h4>Day 2</h4></button>
                          <button class="tablinks" onclick="openCity(event, 'Day3')"><h4>Day 3</h4></button>
                        </div>

                        <!-- Tab content -->
                        <div id="Overview" class="tabcontent">
                          <h2>Overview</h2>
                          <p>Calendar here</p>
                        </div>

                        <div id="Day1" class="tabcontent">
                            <div class="dayContent">
                            <div class="half-tab">
                              <h2>Day 1</h2>
                              <div id="directions-panel"></div>
                            </div>

                                                                        <div id="map"></div>
                                                                        <script>
                                                                          function initMap() {
                                                                            var directionsService = new google.maps.DirectionsService;
                                                                            var directionsDisplay = new google.maps.DirectionsRenderer;
                                                                            var map = new google.maps.Map(document.getElementById('map'), {
                                                                              zoom: 6,
                                                                              center: {lat: 41.85, lng: -87.65}
                                                                            });
                                                                            directionsDisplay.setMap(map);

                                                                            document.getElementById('submit').addEventListener('click', function() {
                                                                              calculateAndDisplayRoute(directionsService, directionsDisplay);
                                                                            });
                                                                          }

                                                                          function calculateAndDisplayRoute(directionsService, directionsDisplay) {
                                                                            var waypts = [];
                                                                            var checkboxArray = [{lat: 43.70, lng: -79.42},{lat: 45.52, lng: -73.66}];
                                                                            for (var i = 0; i < checkboxArray.length; i++) {
                                                                                waypts.push({
                                                                                  location: checkboxArray[i],
                                                                                  stopover: true
                                                                                });
                                                                            }

                                                                            directionsService.route({
                                                                              origin: {lat: 41.85, lng: -87.65},
                                                                              destination: {lat: 45.85, lng: -87.65},
                                                                              waypoints: waypts,
                                                                              optimizeWaypoints: true,
                                                                              travelMode: 'DRIVING'
                                                                            }, function(response, status) {
                                                                              if (status === 'OK') {
                                                                                directionsDisplay.setDirections(response);
                                                                                var route = response.routes[0];
                                                                                var summaryPanel = document.getElementById('directions-panel');
                                                                                summaryPanel.innerHTML = '';
                                                                                // For each route, display summary information.
                                                                                for (var i = 0; i < route.legs.length; i++) {
                                                                                  var routeSegment = i + 1;
                                                                                  summaryPanel.innerHTML += '<div class="LocationDesc"> <p class="ptLetter"> POINT A</p><p class="ptTime">9:20 AM</p><p class="ptName">HOTEL</p></div>';
                                                                                  summaryPanel.innerHTML += '<div class="locDivider"> <hr/> </div>';
                                                                                  summaryPanel.innerHTML += '<div class="TransMode"> <p> Bus (#12). 20 min </div>';
                                                                                  summaryPanel.innerHTML += '<div class="locDivider"> <hr/> </div>';
                                                                                  summaryPanel.innerHTML += '<div class="LocationDesc" style="text-align:right;"> <p class="ptLetter"> POINT B</p><p class="ptTime">9:40 AM</p><p class="ptName">GREAT SPHINX OF EGYPT</p></div>';
                                                                                  summaryPanel.innerHTML += '<div class="Suggestion"><div class="lenStay"> <p class="suggTime">Suggested: 3 hours</p> <p class="depTime">Suggested departure: 12:30 PM</p></div></div>';

                                                                                  /*
                                                                                  summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment +
                                                                                      '</b><br>';
                                                                                  summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                                                                                  summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
                                                                                  summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';
                                                                                  */

                                                                                }
                                                                              } else {
                                                                                window.alert('Directions request failed due to ' + status);
                                                                              }
                                                                            });
                                                                          }
                                                                        </script>
                                                                    <script async defer
                                                                    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAbUR_7faWzM6YBbcDtBXBLOfvpGc6L_Iw&callback=initMap">
                                                                    </script>
                                    </div>
                            </div>

                        <div id="Day2" class="tabcontent">
                            <div class="dayContent">
                               <div class="half-tab">
                                  <h2>Day 2</h2>
                                  <p>Paris is the capital of France.</p>
                                </div>
                            </div>
                            <div id="map"></div>
                        </div>

                        <div id="Day3" class="tabcontent">
                            <div class="dayContent">
                               <div class="half-tab">
                                  <h2>Day 3</h2>
                                  <p>Tokyo is the capital of Japan.</p>
                                </div>
                            </div>
                        </div>

                </hr>
            <!-- </div> -->
        </div>

        <script>
            function openCity(evt, cityName) {
            // Declare all variables
            var i, tabcontent, tablinks;

            // Get all elements with class="tabcontent" and hide them
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        </script>
    </body>
</html>
{% else %}
    ACCESS DENIED
{% endif %}
{% endblock %}